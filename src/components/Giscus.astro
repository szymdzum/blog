---
import { siteConfig } from "@/site-config";

interface Props {
  class?: string;
}

const { class: className } = Astro.props;

const themeUrl = import.meta.env.DEV
  ? `${Astro.url.origin}/giscus-theme.css`
  : `${siteConfig.url}/giscus-theme.css`;
---

<div class:list={["giscus-wrapper", className]}>
  <script
    is:inline
    src="https://giscus.app/client.js"
    data-repo={siteConfig.giscus.repo}
    data-repo-id={siteConfig.giscus.repoId}
    data-category={siteConfig.giscus.category}
    data-category-id={siteConfig.giscus.categoryId}
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="bottom"
    data-theme={themeUrl}
    data-lang="en"
    data-loading="lazy"
    crossorigin="anonymous"
    async
  ></script>
  <noscript>
    <p class="noscript-fallback">
      Comments require JavaScript. View the discussion on{" "}
      <a
        href={`https://github.com/${siteConfig.giscus.repo}/discussions`}
        target="_blank"
        rel="noopener noreferrer"
      >
        GitHub Discussions
      </a>.
    </p>
  </noscript>
</div>

<style>
  .giscus-wrapper {
    margin-top: var(--space-3xl);
    padding-top: var(--space-2xl);
    border-top: var(--border-width) solid var(--color-border);
  }

  .noscript-fallback {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .noscript-fallback a {
    color: var(--color-primary);
  }
</style>
